<manifest xmlns:android="http://schemas.android.com/apk/res/android">

    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
    <uses-permission android:name="android.permission.INTERNET" />

    <application>
        <provider
            android:name="org.libreoffice.androidlib.WebViewInitProvider"
            android:authorities="${applicationId}.webview_init_provider"
            android:exported="false"
            android:process=":loactivity" />

        <activity
            android:name="org.libreoffice.androidlib.LOActivity"
            android:configChanges="orientation|screenSize|screenLayout|keyboardHidden"
            android:launchMode="singleTask"
            android:process=":loactivity"
            android:exported="true">

            <intent-filter>
                <action android:name="android.intent.action.VIEW" />
                <action android:name="android.intent.action.EDIT" />
                <action android:name="android.intent.action.PICK" />
                <category android:name="android.intent.category.DEFAULT" />

                <data android:scheme="file" />
                <data android:scheme="content" />

                <!-- OOXML: DOCX / XLSX / PPTX -->
                <data android:mimeType="application/vnd.openxmlformats-officedocument.wordprocessingml.document" />
                <data android:mimeType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" />
                <data android:mimeType="application/vnd.openxmlformats-officedocument.presentationml.presentation" />
                <data android:mimeType="application/vnd.openxmlformats-officedocument.presentationml.slideshow" />

                <!-- OOXML templates -->
                <data android:mimeType="application/vnd.openxmlformats-officedocument.wordprocessingml.template" />
                <data android:mimeType="application/vnd.openxmlformats-officedocument.spreadsheetml.template" />
                <data android:mimeType="application/vnd.openxmlformats-officedocument.presentationml.template" />

                <!-- Legacy Microsoft -->
                <data android:mimeType="application/msword" />
                <data android:mimeType="application/vnd.ms-excel" />
                <data android:mimeType="application/vnd.ms-powerpoint" />

                <!-- OTHER -->
                <data android:mimeType="application/pdf" />
                <data android:mimeType="text/plain" />
            </intent-filter>

            <!-- ChromeOS and file manager support based on file extension -->
            <intent-filter>
                <action android:name="android.intent.action.VIEW" />
                <action android:name="android.intent.action.EDIT" />
                <action android:name="android.intent.action.PICK" />

                <category android:name="android.intent.category.DEFAULT" />

                <data android:scheme="file" />
                <data android:scheme="content" />
                <data android:host="*" />
                <data android:mimeType="*/*" />

                <!-- DOCX -->
                <data android:pathPattern=".*\\.docx" />
                <data android:pathPattern=".*\\..*\\.docx" />
                <data android:pathPattern=".*\\..*\\..*\\.docx" />
                <data android:pathPattern=".*\\..*\\..*\\..*\\.docx" />
                <data android:pathPattern=".*\\..*\\..*\\..*\\..*\\.docx" />
                <data android:pathPattern=".*\\..*\\..*\\..*\\..*\\..*\\.docx" />
                <data android:pathPattern=".*\\..*\\..*\\..*\\..*\\..*\\..*\\.docx" />

                <!-- XLSX -->
                <data android:pathPattern=".*\\.xlsx" />
                <data android:pathPattern=".*\\..*\\.xlsx" />
                <data android:pathPattern=".*\\..*\\..*\\.xlsx" />
                <data android:pathPattern=".*\\..*\\..*\\..*\\.xlsx" />
                <data android:pathPattern=".*\\..*\\..*\\..*\\..*\\.xlsx" />
                <data android:pathPattern=".*\\..*\\..*\\..*\\..*\\..*\\.xlsx" />
                <data android:pathPattern=".*\\..*\\..*\\..*\\..*\\..*\\..*\\.xlsx" />

                <!-- PPTX -->
                <data android:pathPattern=".*\\.pptx" />
                <data android:pathPattern=".*\\..*\\.pptx" />
                <data android:pathPattern=".*\\..*\\..*\\.pptx" />
                <data android:pathPattern=".*\\..*\\..*\\..*\\.pptx" />
                <data android:pathPattern=".*\\..*\\..*\\..*\\..*\\.pptx" />
                <data android:pathPattern=".*\\..*\\..*\\..*\\..*\\..*\\.pptx" />
                <data android:pathPattern=".*\\..*\\..*\\..*\\..*\\..*\\..*\\.pptx" />
            </intent-filter>
        </activity>

    </application>

</manifest>
